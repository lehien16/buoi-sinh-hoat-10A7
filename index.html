<!doctype html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√≤ Ch∆°i X√© T√∫i M√π</title>
    <script src="/_sdk/element_sdk.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&amp;family=Quicksand:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
    
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Baloo 2', cursive;
            background: linear-gradient(135deg, #FFE5F1 0%, #FFF0E6 25%, #F0F8FF 50%, #F5F0FF 75%, #FFE5F1 100%);
            min-height: 100%;
            overflow-x: hidden;
            position: relative;
        }

        html {
            height: 100%;
        }

        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-candy {
            position: absolute;
            font-size: 1.5rem;
            animation: float 6s ease-in-out infinite;
            opacity: 0.3;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-15px) rotate(5deg); }
            50% { transform: translateY(-30px) rotate(-5deg); }
            75% { transform: translateY(-15px) rotate(3deg); }
        }

        .container {
            max-width: 90vw;
            margin: 0 auto;
            padding: 20px;
            min-height: 100%;
            position: relative;
            z-index: 2;
        }

        .slide {
            display: none;
            height: calc(100vh - 40px);
            width: 100%;
            max-width: 95vw;
            padding: 20px;
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.85); 
            backdrop-filter: blur(15px);
            box-shadow: 0 20px 60px rgba(255, 182, 193, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
            margin: 0 auto;
            border: 2px solid rgba(255, 192, 203, 0.2);
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            justify-content: flex-start; 
            align-items: center;
            text-align: center;
        }

        .slide#slide3 .title,
        .slide#slide3 p {
            position: relative;
            z-index: 10;
            margin-bottom: 1rem;
        }

        .slide#slide3 > div:last-child {
            position: relative;
            z-index: 10;
            margin-top: 1rem;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 182, 193, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(173, 216, 230, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(255, 218, 185, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .title {
            font-family: 'Quicksand', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #FF69B4, #FFB6C1, #DDA0DD, #87CEEB);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            top: -80px;
            text-shadow: 0 4px 8px rgba(255, 105, 180, 0.2);
            animation: titleGlow 3s ease-in-out infinite alternate;
            position: relative;
        }

        @keyframes titleGlow {
            0% { filter: drop-shadow(0 0 10px rgba(255, 105, 180, 0.3)); }
            100% { filter: drop-shadow(0 0 20px rgba(255, 105, 180, 0.6)); }
        }

        .subtitle {
            font-size: 1.4rem;
            color: #8B7D8B;
            position: relative; 
            top: -130px;
            font-weight: 500;
            line-height: 1.6;
        }

        .slogan {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.8rem;
            color: #FF69B4;
            font-weight: 100;
            margin: 2rem 0;
            padding: 1.5rem 3rem;
            top: -180px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 240, 245, 0.9));
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(255, 105, 180, 0.2);
            border: 2px solid rgba(255, 182, 193, 0.3);
            animation: pulse 3s infinite;
            position: relative;
            overflow: hidden;
            display: flex;             
            align-items: center;
            justify-content: center;
        }

        .slogan::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 4s infinite; 
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .btn {
            background: linear-gradient(45deg, #FFB6C1, #DDA0DD, #87CEEB);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.3rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 8px 25px rgba(255, 182, 193, 0.4);
            font-family: 'Baloo 2', cursive;
            margin: 15px;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 35px rgba(255, 182, 193, 0.6);
        }

        .candy-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(200px, 220px));
            gap: 40px;
            max-width: 1200px;
            width: 100%;
            margin: 1rem auto;
            padding: 20px;
            justify-items: center;
            justify-content: center;
        }

        .candy-wrapper {
            position: relative;
            width: 220px;
            height: 110px;
            margin: 0 auto;
            perspective: 1000px;
        }

        .candy-grid .candy-wrapper:nth-child(9),
        .candy-grid .candy-wrapper:nth-child(10) {
            grid-column: span 2;
            justify-self: center;
            max-width: 215px;
            width: 100%;
        }

        .candy-grid .candy-wrapper:nth-child(9) {
            margin-right: 4%;
        }

        .candy-grid .candy-wrapper:nth-child(10) {
            margin-left: 4%;
        }

        .candy {
            width: 100%;
            height: 100%;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.2),
                inset 0 5px 15px rgba(255, 255, 255, 0.4),
                0 0 0 3px rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .candy::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(0deg, 
                    transparent 0%, transparent 2%,
                    rgba(255,255,255,0.7) 2%, rgba(255,255,255,0.7) 4%,
                    transparent 4%, transparent 6%,
                    rgba(255,255,255,0.7) 6%, rgba(255,255,255,0.7) 8%,
                    transparent 8%, transparent 10%,
                    rgba(255,255,255,0.7) 10%, rgba(255,255,255,0.7) 12%,
                    transparent 12%, transparent 14%,
                    rgba(255,255,255,0.7) 14%, rgba(255,255,255,0.7) 16%,
                    transparent 16%, transparent 18%,
                    rgba(255,255,255,0.7) 18%, rgba(255,255,255,0.7) 20%,
                    transparent 20%, transparent 80%,
                    rgba(255,255,255,0.7) 80%, rgba(255,255,255,0.7) 82%,
                    transparent 82%, transparent 84%,
                    rgba(255,255,255,0.7) 84%, rgba(255,255,255,0.7) 86%,
                    transparent 86%, transparent 88%,
                    rgba(255,255,255,0.7) 88%, rgba(255,255,255,0.7) 90%,
                    transparent 90%, transparent 92%,
                    rgba(255,255,255,0.7) 92%, rgba(255,255,255,0.7) 94%,
                    transparent 94%, transparent 96%,
                    rgba(255,255,255,0.7) 96%, rgba(255,255,255,0.7) 98%,
                    transparent 98%
                ),
                linear-gradient(0deg, 
                    transparent 0%, transparent 2%,
                    rgba(255,255,255,0.5) 2%, rgba(255,255,255,0.5) 4%,
                    transparent 4%, transparent 6%,
                    rgba(255,255,255,0.5) 6%, rgba(255,255,255,0.5) 8%,
                    transparent 8%, transparent 10%,
                    rgba(255,255,255,0.5) 10%, rgba(255,255,255,0.5) 12%,
                    transparent 12%, transparent 14%,
                    rgba(255,255,255,0.5) 14%, rgba(255,255,255,0.5) 16%,
                    transparent 16%, transparent 18%,
                    rgba(255,255,255,0.5) 18%, rgba(255,255,255,0.5) 20%,
                    transparent 20%, transparent 80%,
                    rgba(255,255,255,0.5) 80%, rgba(255,255,255,0.5) 82%,
                    transparent 82%, transparent 84%,
                    rgba(255,255,255,0.5) 84%, rgba(255,255,255,0.5) 86%,
                    transparent 86%, transparent 88%,
                    rgba(255,255,255,0.5) 88%, rgba(255,255,255,0.5) 90%,
                    transparent 90%, transparent 92%,
                    rgba(255,255,255,0.5) 92%, rgba(255,255,255,0.5) 94%,
                    transparent 94%, transparent 96%,
                    rgba(255,255,255,0.5) 96%, rgba(255,255,255,0.5) 98%,
                    transparent 98%
                );
            clip-path: polygon( 
                0% 10%, 3% 0%, 6% 10%, 9% 0%, 12% 10%, 15% 0%, 18% 10%, 21% 0%, 24% 10%, 27% 0%, 30% 10%,
                30% 90%, 27% 100%, 24% 90%, 21% 100%, 18% 90%, 15% 100%, 12% 90%, 9% 100%, 6% 90%, 3% 100%, 0% 90%,
                100% 90%, 97% 100%, 94% 90%, 91% 100%, 88% 90%, 85% 100%, 82% 90%, 79% 100%, 76% 90%, 73% 100%, 70% 90%,
                70% 10%, 73% 0%, 76% 10%, 79% 0%, 82% 10%, 85% 0%, 88% 10%, 91% 0%, 94% 10%, 97% 0%, 100% 10%
            );
            z-index: 1;
        }

        .candy::after {
            content: attr(data-label);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            color: #8B7D8B;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            font-family: 'Quicksand', sans-serif;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            z-index: 3;
            border: 1px solid rgba(255, 182, 193, 0.3);
        }

        .candy:hover {
            transform: scale(1.08) rotateY(5deg) rotateX(5deg); 
                0 20px 50px rgba(0, 0, 0, 0.3),
                inset 0 5px 15px rgba(255, 255, 255, 0.5),
                0 0 0 3px rgba(255, 255, 255, 0.9);
        }

        .candy-left, .candy-right {
            position: absolute;
            width: 50%;
            height: 100%;
            border-radius: 25px;
            transition: all 1s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
            transform-origin: center;
        }

        .candy-left {
            left: 0;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        .candy-right {
            right: 0;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        .candy.tearing .candy-left {
            transform: translateX(-150px) rotate(-25deg) rotateY(60deg); 
            box-shadow: 10px 0 20px rgba(0,0,0,0.3);
            opacity: 0.9;
        }

        .candy.tearing .candy-right {
            transform: translateX(150px) rotate(25deg) rotateY(-60deg);
            box-shadow: -10px 0 20px rgba(0,0,0,0.3);
            opacity: 0.9;
        }

        .paper-note {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0) rotate(0deg);
            width: 200px;
            height: 120px;
            background: linear-gradient(135deg, #FFF8F0, #FFF0F5, #F0F8FF);
            border-radius: 25px;
            box-shadow: 
                0 20px 60px rgba(255, 105, 180, 0.3),
                inset 0 3px 10px rgba(255, 255, 255, 0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: #8B7D8B;
            text-align: center;
            padding: 25px;
            border: 3px solid rgba(255, 182, 193, 0.4);
            transition: all 0.6s ease;
            z-index: 15;
            opacity: 0;
            backdrop-filter: blur(10px);
        }

        .paper-note::before {
            content: 'üìå';
            position: absolute;
            top: -12px;
            left: 20px;
            font-size: 2rem;
            filter: drop-shadow(3px 3px 6px rgba(0,0,0,0.3));
            animation: pinWiggle 2s infinite; 
        }

        @keyframes pinWiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
        }

        .paper-note.show {
            transform: translate(-50%, -50%) scale(1) rotate(2deg);
            opacity: 1;
        }

        .paper-note.hide {
            transform: translate(-50%, -50%) scale(0) rotate(0deg); 
            opacity: 0;
            pointer-events: none;
        }

        .candy.opened {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(255, 240, 245, 0.6)) !important;
            border: 3px dashed rgba(255, 182, 193, 0.5) !important;
            cursor: not-allowed;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1) !important;
            opacity: 0.7;
        }

        .candy.opened::after {
            content: 'üéÅ ƒê√£ m·ªü';
            background: rgba(255, 182, 193, 0.8) !important;
            color: white !important;
        }

        .candy.opened:hover {
            transform: none !important;
        }

        .candy-1 { background: linear-gradient(45deg, #FFB6C1, #FFC0CB, #FFE4E1); }
        .candy-2 { background: linear-gradient(45deg, #E0BBE4, #DDA0DD, #F0E6FF); }
        .candy-3 { background: linear-gradient(45deg, #FFDAB9, #FFE4B5, #FFF8DC); }
        .candy-4 { background: linear-gradient(45deg, #B0E0E6, #ADD8E6, #E0F6FF); }
        .candy-5 { background: linear-gradient(45deg, #F0E68C, #FFFFE0, #FFFACD); }
        .candy-6 { background: linear-gradient(45deg, #98FB98, #90EE90, #F0FFF0); }
        .candy-7 { background: linear-gradient(45deg, #FFCCCB, #FFA07A, #FFE4E1); }
        .candy-8 { background: linear-gradient(45deg, #D8BFD8, #DDA0DD, #F5F0FF); }
        .candy-9 { background: linear-gradient(45deg, #F5DEB3, #DDBF94, #FDF5E6); }
        .candy-10 { background: linear-gradient(45deg, #AFEEEE, #B0E0E6, #E0FFFF); }

        .question-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #FFE5F1 0%, #FFF0E6 25%, #F0F8FF 50%, #F5F0FF 75%, #FFE5F1 100%);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        .floating-emojis {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1001;
        }

        .floating-emoji {
            position: absolute;
            font-size: 1.5rem;
            animation: float 6s ease-in-out infinite;
            opacity: 0.3;
        }

        .question-card {
            background: linear-gradient(135deg, #FFF8F0, #FFF0F5, #F0F8FF);
            padding: 4rem;
            border-radius: 50px;
            max-width: 1000px;
            min-height: 400px;
            width: 90vw;
            text-align: center;
            box-shadow: 
                0 40px 100px rgba(255, 105, 180, 0.5),
                inset 0 5px 15px rgba(255, 255, 255, 0.9);
            animation: modalSlideIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55), pulseCard 3s ease-in-out infinite;
            position: relative;
            border: 4px solid rgba(255, 182, 193, 0.5);
            overflow: hidden;
        }
        
        .question-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 4s infinite;
            pointer-events: none;
        }

        @keyframes pulseCard {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        @keyframes modalSlideIn {
            0% { transform: scale(0.3) rotate(-10deg); opacity: 0; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .question-text {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.8rem;
            color: #8B7D8B;
            margin-bottom: 2.5rem;
            line-height: 1.7;
            font-weight: 600;
        }

        .answer-input {
            width: 100%;
            padding: 20px 25px;
            font-size: 1.3rem;
            border: 3px solid #FFB6C1;
            border-radius: 30px;
            margin: 1.5rem 0;
            text-align: center;
            font-family: 'Baloo 2', cursive;
            background: rgba(255, 255, 255, 0.95);
            transition: all 0.4s ease;
            box-shadow: inset 0 3px 10px rgba(255, 182, 193, 0.2);
        }

        .answer-input:focus {
            outline: none;
            border-color: #FF69B4;
            box-shadow: 
                0 0 25px rgba(255, 105, 180, 0.4),
                inset 0 3px 10px rgba(255, 182, 193, 0.3);
            transform: scale(1.02);
        }

        .question-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .btn-correct {
            background: linear-gradient(45deg, #98FB98, #90EE90, #F0FFF0);
            color: #2E8B57;
        }

        .btn-wrong {
            background: linear-gradient(45deg, #FFCCCB, #FFA07A, #FFE4E1);
            color: #CD5C5C;
        }

        .btn-close {
            background: linear-gradient(45deg, #D3D3D3, #C0C0C0, #F5F5F5);
            color: #696969;
        }

        .btn-challenge {
            background: linear-gradient(45deg, #FFD700, #FFFFE0, #FFFACD);
            color: #B8860B;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2000;
        }

        .firework {
            position: absolute;
            font-size: 3rem;
            animation: fireworkExplode 1.5s ease-out forwards;
            will-change: transform, opacity;
        }

        @keyframes fireworkExplode {
            0% { transform: scale(0) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.8) rotate(180deg); opacity: 0.9; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 6px;
            background: linear-gradient(90deg, #FFB6C1, #DDA0DD, #87CEEB);
            transition: width 0.5s ease;
            z-index: 101;
            box-shadow: 0 2px 10px rgba(255, 182, 193, 0.5);
        }

        .navigation {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 100;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #FFB6C1;
            color: #FF69B4;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'Baloo 2', cursive;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: #FFB6C1;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 182, 193, 0.4);
        }

        .sound-effect {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            z-index: 1001;
            animation: soundPulse 1s ease-out;
            pointer-events: none;
        }

        @keyframes soundPulse {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.8; }
            100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
        }

        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0,-30px,0); }
            70% { transform: translate3d(0,-15px,0); }
            90% { transform: translate3d(0,-4px,0); }
        }

        @keyframes swing {
            20% { transform: rotate3d(0,0,1,15deg); }
            40% { transform: rotate3d(0,0,1,-10deg); }
            60% { transform: rotate3d(0,0,1,5deg); }
            80% { transform: rotate3d(0,0,1,-5deg); }
            100% { transform: rotate3d(0,0,1,0deg); }
        }

        @keyframes tada {
            0% { transform: scale3d(1,1,1); }
            10%, 20% { transform: scale3d(.9,.9,.9) rotate3d(0,0,1,-3deg); }
            30%, 50%, 70%, 90% { transform: scale3d(1.1,1.1,1.1) rotate3d(0,0,1,3deg); }
            40%, 60%, 80% { transform: scale3d(1.1,1.1,1.1) rotate3d(0,0,1,-3deg); }
            100% { transform: scale3d(1,1,1); }
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: scale3d(.3,.3,.3); }
            20% { transform: scale3d(1.1,1.1,1.1); }
            40% { transform: scale3d(.9,.9,.9); }
            60% { opacity: 1; transform: scale3d(1.03,1.03,1.03); }
            80% { transform: scale3d(.97,.97,.97); }
            100% { opacity: 1; transform: scale3d(1,1,1); }
        }

        @keyframes fadeInUp {
            0% { opacity: 0; transform: translate3d(0,100%,0); }
            100% { opacity: 1; transform: translate3d(0,0,0); }
        }

        thank-you-frame {
            border: 5px solid #FFB6C1;
            border-radius: 25px;
            padding: 2.5rem;
            margin: 2rem auto;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 240, 245, 0.95));
            max-width: 700px;
            position: relative;
            box-shadow: 0 15px 40px rgba(255, 105, 180, 0.3);
            backdrop-filter: blur(15px);
            text-align: center;
            min-height: 350px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .thank-you-message {
            font-family: 'Quicksand', sans-serif;
            font-size: 2rem;
            color: #FF69B4;
            font-weight: 600;
            margin: 1.5rem 0;
            line-height: 1.6;
            animation: pulse 3s infinite;
            position: relative; 
            top: 100px;
        }
        .thank-you-emoji {
            font-size: 6rem;
            position: relative; 
            top: 100px;
            animation: bounce 2s infinite;
        }

        .countdown-timer {
            position: absolute;
            top: 20px;
            right: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 18px 25px;
            border-radius: 50px;
            box-shadow: 0 15px 40px rgba(255, 105, 180, 0.4);
            border: 4px solid #FFB6C1;
            font-family: 'Baloo 2', cursive;
            font-size: 2.2rem;
            font-weight: 700;
            color: #FF1493;
            backdrop-filter: blur(10px);
            z-index: 1002;
            animation: bounceIn 0.8s ease-out;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .countdown-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(#FF69B4 0deg, #FFB6C1 0deg);
            position: relative;
            animation: countdownRotate 15s linear forwards;
        }

        .countdown-circle::before {
            content: '';
            position: absolute;
            inset: 8px;
            background: white;
            border-radius: 50%;
        }

        .countdown-circle::after {
            content: '‚è∞';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.8rem;
        }

        @keyframes countdownRotate {
            from { background: conic-gradient(#FF69B4 360deg, #FFB6C1 0deg); }
            to   { background: conic-gradient(#FF69B4 0deg, #FFB6C1 360deg); }
        }

        .countdown-text {
            animation: pulse 1s infinite;
            text-shadow: 0 0 20px rgba(255,20,147,0.6);
        }

        .countdown-warning {
            color: #FF4500 !important;
            animation: heartbeat 0.6s infinite !important;
        }

        #playButton:active {
            transform: scale(0.95);
        }

        .play-button-initial {
            font-size: 1rem; 
            padding: 5px 22px; 
            background: linear-gradient(45deg, #FF1493, #FF69B4); 
            box-shadow: 0 20px 50px rgba(255,20,147,0.5); 
            position: relative; 
            left: 800px;
        }

        #playButton.counting {
            position: relative;
            bottom: -225px;
            left: 340px;
        }

        #thinkingMessage {
            animation: pulse 1.5s infinite;
        }
    </style>
    <body>
        <div class="floating-elements">
            <div class="floating-candy" style="top: 10%; left: 5%; animation-delay: 0s;">üç¨</div>
            <div class="floating-candy" style="top: 20%; right: 10%; animation-delay: 1s;">üç≠</div>
            <div class="floating-candy" style="bottom: 30%; left: 15%; animation-delay: 2s;">üßÅ</div>
            <div class="floating-candy" style="bottom: 20%; right: 5%; animation-delay: 0.5s;">üéà</div>
            <div class="floating-candy" style="top: 60%; left: 8%; animation-delay: 1.5s;">üå∏</div>
            <div class="floating-candy" style="top: 70%; right: 12%; animation-delay: 2.5s;">‚ú®</div>
            <div class="floating-candy" style="bottom: 60%; left: 85%; animation-delay: 0.8s;">üåü</div>
            <div class="floating-candy" style="top: 40%; left: 90%; animation-delay: 1.8s;">üíñ</div>
            <div class="floating-candy" style="bottom: 80%; right: 20%; animation-delay: 3s;">ü¶ã</div>
            <div class="floating-candy" style="top: 80%; left: 25%; animation-delay: 2.2s;">üå∫</div>
        </div>

        <div class="progress-bar" id="progressBar"></div>

        <div class="container">
            <div class="slide active" id="slide1">
                <div style="position: absolute; top: 10%; left: 10%; font-size: 4rem; opacity: 0.3; animation: float 4s ease-in-out infinite;">üå∏</div>
                <div style="position: absolute; top: 20%; right: 15%; font-size: 3.5rem; opacity: 0.3; animation: float 5s ease-in-out infinite 1s;">üç≠</div>
                <div style="position: absolute; bottom: 30%; left: 8%; font-size: 3rem; opacity: 0.3; animation: float 6s ease-in-out infinite 2s;">ü¶ã</div>
                <div style="position: absolute; bottom: 25%; right: 12%; font-size: 3.5rem; opacity: 0.3; animation: float 4.5s ease-in-out infinite 0.5s;">‚ú®</div>
                <div style="position: absolute; top: 60%; left: 85%; font-size: 2.5rem; opacity: 0.3; animation: float 5.5s ease-in-out infinite 1.5s;">üíñ</div>
                <div style="animation: bounceIn 2s ease-out; margin-bottom: 2rem; position: relative; z-index: 10;">
                    <div style="font-size: 8rem; margin-bottom: 1.5rem; animation: float 3s ease-in-out infinite; text-shadow: 0 8px 20px rgba(255,105,180,0.3);">üé™üç¨üé≠</div>
                    <h1 class="title" id="gameTitle" style="font-size: 4.5rem; margin-bottom: 1rem;">TR√í CH∆†I X√â T√öI M√ô üç¨</h1>
                </div>
                <div style="animation: fadeInUp 1.5s ease-out 1s both; margin-bottom: 2.5rem; position: relative; z-index: 10;">
                    <p class="subtitle" id="schoolSubtitle" style="font-size: 1.6rem; max-width: 800px; margin: 0 auto; line-height: 1.8;">Bu·ªïi sinh ho·∫°t v·ªõi l·ªõp 10A7 tr∆∞·ªùng THPT Nguy·ªÖn Tr∆∞·ªùng T·ªô</p>
                </div>
                <div class="slogan" id="gameSlogan" style="font-size: 2.2rem; padding: 1rem 2rem; margin: 2.5rem auto; max-width: 900px; position: relative; z-index: 10;">
                    C√πng x√© k·∫πo ‚Äì C√πng vui ‚Äì C√πng th∆∞ gi√£n üíñ
                </div>
                <div style="animation: fadeInUp 2s ease-out 2s both; margin: 2rem auto; max-width: 700px; position: relative; z-index: 10;">
                    <p style="font-size: 1.4rem; color: #8B7D8B; line-height: 1.6; position: relative; top: -230px;">üåü Ch√†o m·ª´ng c√°c em ƒë·∫øn v·ªõi tr√≤ ch∆°i t∆∞∆°ng t√°c ƒë·∫ßy m√†u s·∫Øc! <br>
                       H√£y c√πng nhau kh√°m ph√° nh·ªØng c√¢u h·ªèi th√∫ v·ªã! üåà</p>
                </div>
                <div style="animation: pulse 2s infinite; animation-delay: 2.5s; margin-top: -250px; position: relative; z-index: 10;">
                    <button class="btn" onclick="nextSlide()" style="font-size: 1.5rem; padding: 10px 40px; box-shadow: 0 15px 40px rgba(255, 182, 193, 0.5);"> üöÄ Hi·ªÉn th·ªã lu·∫≠t ch∆°i! üå∏ </button>
                </div>
            </div>

            <div class="slide" id="slide2">
                <h2 class="title" style="font-size: 3.8rem; position: relative; top: 0px;">LU·∫¨T CH∆†I üéÆ</h2>
                <div class="tutorial-carousel" style="position: relative; max-width: 1000px; margin: 0 auto;">
                    <div class="tutorial-slides" id="tutorialSlides" style="display: flex; transition: transform 0.5s ease;">
                        <!-- B∆∞·ªõc 1 -->
                        <div class="tutorial-step" style="min-width: 100%; padding: 0 20px;">
                            <div style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 240, 245, 0.95)); border-radius: 30px; padding: 20px; box-shadow: 0 20px 50px rgba(255, 105, 180, 0.3); border: 3px solid rgba(255, 182, 193, 0.4); text-align: center; min-height: 200px; display: flex; flex-direction: column; justify-content: center; margin-top: 10px;">
                                <div style="font-size: 6rem; margin-bottom: 2rem; animation: bounce 2s infinite;">üëÜüç¨</div>
                                <h3 style="color: #FF69B4; margin-bottom: 2rem; font-family: 'Quicksand', sans-serif; font-size: 2.2rem; font-weight: 700;">B∆∞·ªõc 1: Ch·ªçn t√∫i m√π</h3>
                                <p style="font-size: 1.4rem; color: #8B7D8B; line-height: 1.8; max-width: 500px; margin: 0 auto;">B·∫•m v√†o m·ªôt trong 10 t√∫i m√π ƒë·ªÉ b·∫Øt ƒë·∫ßu l∆∞·ª£t ch∆°i!</p>
                            </div>
                        </div>
                        <!-- B∆∞·ªõc 2 -->
                        <div class="tutorial-step" style="min-width: 100%; padding: 0 20px;">
                            <div style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 248, 255, 0.95)); border-radius: 30px; padding: 20px; box-shadow: 0 20px 50px rgba(173, 216, 230, 0.3); border: 3px solid rgba(173, 216, 230, 0.4); text-align: center; min-height: 200px; display: flex; flex-direction: column; justify-content: center; margin-top: 10px;">
                                <div style="font-size: 6rem; margin-bottom: 2rem; animation: pulse 2s infinite;">üí•üìù</div>
                                <h3 style="color: #87CEEB; margin-bottom: 2rem; font-family: 'Quicksand', sans-serif; font-size: 2.2rem; font-weight: 700;">B∆∞·ªõc 2: T√∫i m√π x√© ra</h3>
                                <p style="font-size: 1.4rem; color: #8B7D8B; line-height: 1.8; max-width: 500px; margin: 0 auto;">T√∫i m√π s·∫Ω ƒë∆∞·ª£c x√© ra v√† l·ªô ra c√¢u h·ªèi b√≠ ·∫©n b√™n trong!</p>
                            </div>
                        </div>
                        <!-- B∆∞·ªõc 3 -->
                        <div class="tutorial-step" style="min-width: 100%; padding: 0 20px;">
                            <div style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 218, 185, 0.95)); border-radius: 30px; padding: 20px; box-shadow: 0 20px 50px rgba(255, 218, 185, 0.3); border: 3px solid rgba(255, 218, 185, 0.4); text-align: center; min-height: 200px; display: flex; flex-direction: column; justify-content: center; margin-top: 10px;">
                                <div style="font-size: 6rem; margin-bottom: 2rem; animation: swing 2s infinite;">‚úçÔ∏èüí≠</div>
                                <h3 style="color: #DDA0DD; margin-bottom: 2rem; font-family: 'Quicksand', sans-serif; font-size: 2.2rem; font-weight: 700;">B∆∞·ªõc 3: Tr·∫£ l·ªùi c√¢u h·ªèi</h3>
                                <p style="font-size: 1.4rem; color: #8B7D8B; line-height: 1.8; max-width: 800px; margin: 0 auto;">Suy nghƒ© v√† nh·∫≠p c√¢u tr·∫£ l·ªùi. N·∫øu sai - C∆° h·ªôi s·∫Ω thu·ªôc v·ªÅ b·∫°n kh√°c!</p>
                            </div>
                        </div>
                        <!-- B∆∞·ªõc 4 -->
                        <div class="tutorial-step" style="min-width: 100%; padding: 0 20px;">
                            <div style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(152, 251, 152, 0.95)); border-radius: 30px; padding: 20px; box-shadow: 0 20px 50px rgba(152, 251, 152, 0.3); border: 3px solid rgba(152, 251, 152, 0.4); text-align: center; min-height: 200px; display: flex; flex-direction: column; justify-content: center; margin-top: 10px;">
                                <div style="font-size: 6rem; margin-bottom: 2rem; animation: tada 2s infinite;">ü•®‚ú®</div>
                                <h3 style="color: #32CD32; margin-bottom: 2rem; font-family: 'Quicksand', sans-serif; font-size: 2.2rem; font-weight: 700;">B∆∞·ªõc 4: Nh·∫≠n ph·∫ßn th∆∞·ªüng!</h3>
                                <p style="font-size: 1.4rem; color: #8B7D8B; line-height: 1.8; max-width: 500px; margin: 0 auto;">Tr·∫£ l·ªùi ƒë√∫ng s·∫Ω ƒë∆∞·ª£c 1 set k·∫πo!</p>
                            </div>
                        </div>
                    </div>
                    <div class="tutorial-dots" style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
                        <div class="tutorial-dot active" onclick="goToTutorialStep(0)" style="width: 15px; height: 15px; border-radius: 50%; background: #FF69B4; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 3px 10px rgba(255,105,180,0.4);"></div>
                        <div class="tutorial-dot" onclick="goToTutorialStep(1)" style="width: 15px; height: 15px; border-radius: 50%; background: rgba(255,105,180,0.3); cursor: pointer; transition: all 0.3s ease;"></div>
                        <div class="tutorial-dot" onclick="goToTutorialStep(2)" style="width: 15px; height: 15px; border-radius: 50%; background: rgba(255,105,180,0.3); cursor: pointer; transition: all 0.3s ease;"></div>
                        <div class="tutorial-dot" onclick="goToTutorialStep(3)" style="width: 15px; height: 15px; border-radius: 50%; background: rgba(255,105,180,0.3); cursor: pointer; transition: all 0.3s ease;"></div>
                    </div>
                    <button onclick="prevTutorialStep()" style="position: absolute; left: -60px; top: 190px; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: 2px solid #FFB6C1; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; font-size: 1.5rem; color: #FF69B4; transition: all 0.3s ease;">‚Äπ</button>
                    <button onclick="nextTutorialStep()" style="position: absolute; right: -60px; top: 190px; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: 2px solid #FFB6C1; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; font-size: 1.5rem; color: #FF69B4; transition: all 0.3s ease;">‚Ä∫</button>
                </div>
                <div style="text-align: center; margin-top: 3rem;">
                    <p style="font-size: 1.6rem; color: #8B7D8B; position: relative; top: -40px; font-weight: 600;">üí° <strong>Ch√∫ th√≠ch:</strong> Tr·∫£ l·ªùi sai kh√¥ng sao - h√£y th·ª≠ l·∫°i! üåü</p>
                    <button class="btn" onclick="nextSlide3()" style="font-size: 1.5rem; padding: 10px 40px; box-shadow: 0 15px 40px rgba(255, 182, 193, 0.5); position: relative; top: -50px;"> üéÆ S·∫µn s√†ng ch∆°i! üå∏ </button>
                </div>
            </div>

            <div class="slide" id="slide3">
                <h2 class="title" style="position: relative; top: -10px;">CH·ªåN T√öI M√ô! üç¨</h2>
                <p style="font-size: 1.3rem; color: #8B7D8B; position: relative; top: -30px;">M·ªói t√∫i m√π ch·ª©a m·ªôt c√¢u h·ªèi/ th·ª≠ th√°ch th√∫ v·ªã</p>
                <div class="candy-grid" id="candyGrid" style="grid-template-columns: repeat(4, 1fr); max-width: 1400px; position: relative; top: -50px;">
                </div>
                <div style="position: relative; margin-top: 2rem; text-align: right;">
                    <button class="btn" onclick="resetGame()" style="background: linear-gradient(45deg, #FFB6C1, #DDA0DD, #87CEEB); position: absolute; left: 400px; top: -100px; padding: 10px 40px; z-index: 15; white-space: nowrap; min-width: 150px;">üîÑ Ch∆°i l·∫°i</button>
                </div>
            </div>

            <div class="slide" id="slide4">
                <div style="position: absolute; top: 10%; left: 10%; font-size: 4rem; opacity: 0.3; animation: float 4s ease-in-out infinite;">üå∏</div>
                <div style="position: absolute; top: 20%; right: 15%; font-size: 3.5rem; opacity: 0.3; animation: float 5s ease-in-out infinite 1s;">üç≠</div>
                <div style="position: absolute; bottom: 30%; left: 8%; font-size: 3rem; opacity: 0.3; animation: float 6s ease-in-out infinite 2s;">ü¶ã</div>
                <div style="position: absolute; bottom: 25%; right: 12%; font-size: 3.5rem; opacity: 0.3; animation: float 4.5s ease-in-out infinite 0.5s;">‚ú®</div>
                <div style="position: absolute; top: 60%; left: 85%; font-size: 2.5rem; opacity: 0.3; animation: float 5.5s ease-in-out infinite 1.5s;">üíñ</div>
                <h2 class="title" style="position: relative; top: 100px;">C·∫¢M ∆†N C√ÅC EM! üéâ</h2>
                <div class="thank-you-frame">
                    <div class="thank-you-emoji">üéä</div>
                    <p class="thank-you-message">C·∫£m ∆°n c√°c em ƒë√£ tham gia tr√≤ ch∆°i X√© T√∫i M√π! <br> H·∫πn g·∫∑p l·∫°i ·ªü nh·ªØng bu·ªïi sau nh√©! üíñ</p>
                    <p style="font-size: 1.4rem; color: #8B7D8B; font-family: 'Quicksand', sans-serif; position: relative; top: 100px;">L·ªõp 10A7 - THPT Nguy·ªÖn Tr∆∞·ªùng T·ªô</p>
                    <button class="btn" onclick="resetGame(); goToSlide(1)" style="font-size: 1.5rem; padding: 10px 40px; position: relative; top: 100px;">üîÑ Ch∆°i l·∫°i t·ª´ ƒë·∫ßu</button>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn" onclick="prevSlide()">‚Üê Tr∆∞·ªõc</button>
            <button class="nav-btn" onclick="nextSlide()">Sau ‚Üí</button>
        </div>

        <div class="question-modal" id="questionModal">
            <div class="floating-emojis">
                <div class="floating-emoji" style="top: 10%; left: 5%; animation-delay: 0s;">üç¨</div>
                <div class="floating-emoji" style="top: 20%; right: 10%; animation-delay: 1s;">üç≠</div>
                <div class="floating-emoji" style="bottom: 30%; left: 15%; animation-delay: 2s;">üßÅ</div>
                <div class="floating-emoji" style="bottom: 20%; right: 5%; animation-delay: 0.5s;">üéà</div>
                <div class="floating-emoji" style="top: 60%; left: 8%; animation-delay: 1.5s;">üå∏</div>
                <div class="floating-emoji" style="top: 70%; right: 12%; animation-delay: 2.5s;">‚ú®</div>
                <div class="floating-emoji" style="bottom: 60%; left: 85%; animation-delay: 0.8s;">üåü</div>
                <div class="floating-emoji" style="top: 40%; left: 90%; animation-delay: 1.8s;">üíñ</div>
            </div>
            <div class="question-card">
                <div id="playSection" style="text-align:center;">
                    <button id="playButton" class="btn play-button-initial">
                        ‚ñ∂Ô∏è
                    </button>

                    <div class="countdown-timer" id="countdownTimer" style="display:none; margin: 30px auto; justify-content:center;">
                        <div class="countdown-circle" id="countdownCircle"></div>
                        <div class="countdown-text" id="countdownText">15</div>
                    </div>

                    <div id="thinkingMessage" style="display:none; margin-top: 20px; font-size: 1.8rem; color: #FF69B4; font-weight: 700;">
                        ƒêang suy nghƒ©... ‚è≥
                    </div>
                </div>

                <p class="question-text" id="questionText"></p>
                <div id="answerSection">
                    <input type="text" class="answer-input" id="answerInput" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa em...">
                    <div class="question-buttons" id="questionButtons">
                        <button class="btn btn-correct" onclick="checkAnswer()">‚úÖ Ki·ªÉm tra ƒë√°p √°n</button>
                        <button class="btn btn-close" onclick="closeQuestion()">üîô Tho√°t c√¢u h·ªèi</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="fireworks" id="fireworks"></div>

        <script>
            let currentSlide = 1; 
            const totalSlides = 4; 
            let currentTutorialStep = 0;
            const totalTutorialSteps = 4;
            let openedCandies = new Set(); 

            const correctSound = new Audio('sound/correct.mp3');
            const wrongSound = new Audio('sound/wrong.mp3');

            function playSound(audio) {
                audio.play().catch(error => {
                    console.warn('Failed to play sound:', error);
                });
            }

            const questions = [
                { question: "Th·ªß ƒë√¥ c·ªßa Vi·ªát Nam l√† g√¨?", category: "Ki·∫øn th·ª©c üìò", answer: "h√† n·ªôi", type: "answer" },
                { question: "H√£y gi·ªõi thi·ªáu t√™n v√† m·ªôt ƒëi·ªÅu th√∫ v·ªã v·ªÅ b·∫£n th√¢n!", category: "L√†m quen üí¨", answer: "", type: "challenge" },
                { question: "S√¥ng d√†i nh·∫•t Vi·ªát Nam l√† s√¥ng n√†o?", category: "Ki·∫øn th·ª©c üìò", answer: "m√™ k√¥ng", type: "answer" },
                { question: "Con g√¨ ƒë·∫≠p m·ªôt l√∫c hai l·∫ßn nh∆∞ng kh√¥ng ch·∫øt?", category: "ƒê·ªë m·∫πo üß†", answer: "con tim", type: "answer" },
                { question: "T·ª´ n√†o trong ti·∫øng Vi·ªát c√≥ ch√≠n ch·ªØ h?", category: "ƒê·ªë m·∫πo üß†", answer: "ch√≠nh", type: "answer" },
                { question: "Con g√¨ g·∫∑m nh·∫•m kh√¥ng rƒÉng, d√πng ƒë·ªÉ nh·∫•p v√† ch·ªâ?", category: "ƒê·ªë m·∫πo üß†", answer: " chu·ªôt", type: "answer" },
                { question: "C√°i g√¨ c√†ng r·ª≠a c√†ng b·∫©n?", category: "ƒê·ªë m·∫πo üß†", answer: "n∆∞·ªõc", type: "answer" },
                { question: "Ai l√† ng∆∞·ªùi ƒë·∫ßu ti√™n ƒë·∫∑t ch√¢n l√™n m·∫∑t trƒÉng?", category: "Ki·∫øn th·ª©c üìò", answer: "armstrong", type: "answer" },
                { question: "H√£y n√≥i 'S√°u s√†o s·∫≠y s·∫°t sang s√¥ng' 3 l·∫ßn li√™n ti·∫øp!", category: "Th·ª≠ th√°ch üåà", answer: "", type: "challenge" },
                { question: "Hu·∫ø c√≥ c√¥ng tr√¨nh n√†o ƒë∆∞·ª£c in tr√™n t·ªù ti·ªÅn 50.000 ƒë·ªìng?", category: "Ki·∫øn th·ª©c üìò", answer: "phu vƒÉn l√¢u", type: "answer" }
            ];

            const candyLabels = [
                "1", "2", "3", "4", "5",
                "6", "7", "8", "9", "10"
            ];

            const defaultConfig = {
                game_title: "TR√í CH∆†I X√â T√öI M√ô üç¨",
                school_name: "THPT Nguy·ªÖn Tr∆∞·ªùng T·ªô",
                slogan: "C√πng x√© k·∫πo ‚Äì C√πng vui ‚Äì C√πng th∆∞ gi√£n üíñ"
            };

            function initializeCandyGrid() {
                const grid = document.getElementById('candyGrid');
                grid.innerHTML = '';

                for (let i = 1; i <= 10; i++) {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'candy-wrapper';

                    const candy = document.createElement('div');
                    candy.className = `candy candy-${i}`;
                    candy.id = `candy-${i}`;
                    candy.setAttribute('data-label', candyLabels[i-1]);
                    candy.setAttribute('tabindex', '0');
                    candy.onclick = () => openCandy(i);
                    candy.onkeydown = (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            openCandy(i);
                        }
                    };

                    if (openedCandies.has(i)) {
                        candy.classList.add('opened');
                        candy.setAttribute('tabindex', '-1');
                        const paperNote = document.createElement('div');
                        paperNote.className = 'paper-note';
                        paperNote.id = `paper-${i}`;
                        paperNote.innerHTML = '<div style="font-size: 2.5rem;">‚úÖ</div><div style="font-size: 0.8rem; margin-top: 5px;">ƒê√£ m·ªü</div>';
                        paperNote.style.background = 'linear-gradient(135deg, #98FB98, #90EE90)';
                        paperNote.classList.add('show');
                        wrapper.appendChild(candy);
                        wrapper.appendChild(paperNote);
                    } else {
                        const leftHalf = document.createElement('div');
                        leftHalf.className = 'candy-left';

                        const rightHalf = document.createElement('div');
                        rightHalf.className = 'candy-right';

                        const gradients = {
                            1: 'linear-gradient(45deg, #FFB6C1, #FFC0CB, #FFE4E1)',
                            2: 'linear-gradient(45deg, #E0BBE4, #DDA0DD, #F0E6FF)',
                            3: 'linear-gradient(45deg, #FFDAB9, #FFE4B5, #FFF8DC)',
                            4: 'linear-gradient(45deg, #B0E0E6, #ADD8E6, #E0F6FF)',
                            5: 'linear-gradient(45deg, #F0E68C, #FFFFE0, #FFFACD)',
                            6: 'linear-gradient(45deg, #98FB98, #90EE90, #F0FFF0)',
                            7: 'linear-gradient(45deg, #FFCCCB, #FFA07A, #FFE4E1)',
                            8: 'linear-gradient(45deg, #D8BFD8, #DDA0DD, #F5F0FF)',
                            9: 'linear-gradient(45deg, #F5DEB3, #DDBF94, #FDF5E6)',
                            10: 'linear-gradient(45deg, #AFEEEE, #B0E0E6, #E0FFFF)'
                        };

                        leftHalf.style.background = gradients[i];
                        rightHalf.style.background = gradients[i];

                        candy.appendChild(leftHalf);
                        candy.appendChild(rightHalf);

                        const paperNote = document.createElement('div');
                        paperNote.className = 'paper-note';
                        paperNote.id = `paper-${i}`;

                        wrapper.appendChild(candy);
                        wrapper.appendChild(paperNote);
                    }
                    grid.appendChild(wrapper);
                }

                if (currentSlide === 3) {
                    const firstCandy = document.querySelector('.candy:not(.opened)');
                    if (firstCandy) {
                        firstCandy.focus();
                    }
                }
            }

            let currentQuestion = null;
            let currentCandyNumber = null;

            function openCandy(candyNumber) {
                if (openedCandies.has(candyNumber)) {
                    const paperNote = document.getElementById(`paper-${candyNumber}`);
                    paperNote.classList.add('show');
                    return;
                }

                const candy = document.getElementById(`candy-${candyNumber}`);
                const paperNote = document.getElementById(`paper-${candyNumber}`);
                const selectedQuestion = questions[candyNumber - 1];

                currentQuestion = selectedQuestion;
                currentCandyNumber = candyNumber;

                showSoundEffect('üìÑüí•'); 

                candy.classList.add('tearing');

                paperNote.innerHTML = `
                    <div style="font-size: 0.9rem; color: #FF69B4; margin-bottom: 10px; font-weight: 600;">${selectedQuestion.category}</div>
                    <div style="font-size: 1.1rem; line-height: 1.5;">${selectedQuestion.question}</div>
                `;

                setTimeout(() => {
                    paperNote.classList.add('show');
                }, 600);

                setTimeout(() => {
                    candy.style.opacity = '0';
                    candy.style.pointerEvents = 'none';
                    showQuestion(selectedQuestion.question);
                }, 1200);
            }

            function checkAnswer() {
                const userAnswer = document.getElementById('answerInput').value.trim();

                if (!userAnswer) {
                    const input = document.getElementById('answerInput');
                    input.style.borderColor = '#FF6347';
                    input.placeholder = 'Vui l√≤ng nh·∫≠p c√¢u tr·∫£ l·ªùi!';
                    setTimeout(() => {
                        input.style.borderColor = '#FFB6C1';
                        input.placeholder = 'Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa em...';
                    }, 2000);
                    return;
                }

                let isCorrect = false;

                if (currentQuestion.type === 'challenge') {
                    isCorrect = true;
                } else if (currentQuestion.type === 'answer') {
                    const correctAnswer = currentQuestion.answer.toLowerCase().trim();
                    const userAnswerLower = userAnswer.toLowerCase().trim();

                    const normalizeText = (text) => {
                        return text.replace(/[^\w\s]/g, '').replace(/\s+/g, ' ').trim();
                    };

                    const normalizedCorrect = normalizeText(correctAnswer);
                    const normalizedUser = normalizeText(userAnswerLower);

                    const correctWords = normalizedCorrect.split(' ').filter(word => word.length > 0);
                    isCorrect = correctWords.every(word => normalizedUser.includes(word));

                    if (!isCorrect) {
                        isCorrect = normalizedUser === normalizedCorrect; 
                    }
                }

                if (isCorrect) {
                    correctAnswer();
                } else {
                    wrongAnswer();
                }
            }

            function correctAnswer() {
                stopCountdown();
                openedCandies.add(currentCandyNumber);

                showSoundEffect('üëèüéâ');
                playSound(correctSound);

                createPastelFireworks();

                setTimeout(() => {
                    closeQuestion();
                    currentQuestion = null;
                    currentCandyNumber = null;
                }, 2000);
            }

            function wrongAnswer() {
                stopCountdown();
                showSoundEffect('üö®‚ùå');
                playSound(wrongSound);

                document.body.style.background = 'linear-gradient(135deg, #FFCCCB 0%, #FFE4E1 25%, #FFF0F5 50%, #F5F0FF 75%, #FFE5F1 100%)'; 
                setTimeout(() => {
                    document.body.style.background = 'linear-gradient(135deg, #FFE5F1 0%, #FFF0E6 25%, #F0F8FF 50%, #F5F0FF 75%, #FFE5F1 100%)'; 
                }, 800);

                const input = document.getElementById('answerInput');
                input.value = '';
                input.style.borderColor = '#FF6347';
                input.placeholder = 'Sai r·ªìi! H√£y th·ª≠ l·∫°i nh√© üòä';

                setTimeout(() => {
                    input.style.borderColor = '#FFB6C1';
                    input.placeholder = 'Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa em...';
                }, 2000);

                const paperNote = document.getElementById(`paper-${currentCandyNumber}`);
                paperNote.innerHTML = `
                    <div style="font-size: 0.9rem; color: #FF69B4; margin-bottom: 10px; font-weight: 600;">${currentQuestion.category}</div>
                    <div style="font-size: 1.1rem; line-height: 1.5;">${currentQuestion.question}</div>
                `;
                paperNote.classList.add('show');
                resetToPlayAgain();
            }

            function closeQuestion() {
                stopCountdown();
                resetToPlayAgain();
                document.getElementById('questionModal').style.display = 'none'; 

                if (currentCandyNumber) {
                    const paperNote = document.getElementById(`paper-${currentCandyNumber}`);
                    if (!openedCandies.has(currentCandyNumber)) {
                        paperNote.innerHTML = `
                            <div style="font-size: 0.9rem; color: #FF69B4; margin-bottom: 10px; font-weight: 600;">${currentQuestion.category}</div>
                            <div style="font-size: 1.1rem; line-height: 1.5;">${currentQuestion.question}</div>
                        `;
                        paperNote.classList.add('show');
                    }
                }

                currentQuestion = null;
                currentCandyNumber = null;
            }

            function closeQuestionAsCorrect() {
                correctAnswer();
            }

            function showSoundEffect(emoji) {
                const soundDiv = document.createElement('div');
                soundDiv.className = 'sound-effect';
                soundDiv.textContent = emoji;
                document.body.appendChild(soundDiv);

                setTimeout(() => {
                    soundDiv.remove();
                }, 1000);
            }

            function createPastelFireworks() {
                const fireworksContainer = document.getElementById('fireworks');
                const pastelEmojis = ['üå∏', 'üå∫', 'ü¶ã', '‚ú®', 'üíñ', 'üåü', 'üí´', 'üéä', 'üåà', 'üíï'];

                if (!fireworksContainer) {
                    console.error('Fireworks container not found!');
                    return;
                }

                for (let i = 0; i < 40; i++) {
                    setTimeout(() => {
                        const firework = document.createElement('div');
                        firework.className = 'firework';
                        firework.textContent = pastelEmojis[Math.floor(Math.random() * pastelEmojis.length)];
                        firework.style.position = 'fixed';
                        firework.style.left = `${Math.random() * 80 + 10}%`;
                        firework.style.top = `${Math.random() * 80 + 10}%`;

                        fireworksContainer.appendChild(firework);

                        setTimeout(() => {
                            firework.remove();
                        }, 1500);
                    }, i * 50);
                }
            }

            function startFireworksLoop() {
                if (fireworksInterval) clearInterval(fireworksInterval);
                fireworksInterval = setInterval(createPastelFireworks, 2000);
            }
            
            function stopFireworksLoop() {
                if (fireworksInterval) {
                    clearInterval(fireworksInterval);
                    fireworksInterval = null;
                }
                const fireworksContainer = document.getElementById('fireworks');
                fireworksContainer.innerHTML = '';
            }

            function nextSlide() {
                if (currentSlide === 2) {
                    if (currentTutorialStep < totalTutorialSteps - 1) {
                        nextTutorialStep();
                        return;
                    }
            
                    resetGame();
                    goToSlide(3);
                    return;
                }
            
                if (currentSlide < totalSlides) {
                    goToSlide(currentSlide + 1);
                }
            }

            function nextSlide3() {
                if (currentSlide === 2) {
                    resetGame();
                    goToSlide(3);
                }
            }

            function prevSlide() {
                if (currentSlide === 2) {
                    if (currentTutorialStep > 0) {
                        prevTutorialStep();
                        return;
                    }
                }
                if (currentSlide > 1) {
                    goToSlide(currentSlide - 1);
                }
            }

            function goToSlide(slideNumber) {
                document.getElementById(`slide${currentSlide}`).classList.remove('active');
                currentSlide = slideNumber;
                document.getElementById(`slide${currentSlide}`).classList.add('active'); 

                const progress = (currentSlide / totalSlides) * 100;
                document.getElementById('progressBar').style.width = progress + '%'; 

                if (currentSlide === 2) {
                    goToTutorialStep(0);
                } else {
                    stopTutorialAutoplay();
                }

                if (currentSlide === 3) {
                    initializeCandyGrid();
                }

                if (currentSlide === 4) {
                    startFireworksLoop();
                    document.querySelector('.btn').focus();
                }
            }

            function resetGame() {
                openedCandies.clear();
                initializeCandyGrid(); 
                showSoundEffect('üîÑ‚ú®'); 
            }

            function goToTutorialStep(step) {
                currentTutorialStep = step;
                const slides = document.getElementById('tutorialSlides');
                const dots = document.querySelectorAll('.tutorial-dot');

                if (slides) {
                    slides.style.transform = `translateX(-${step * 100}%)`; 
                }

                dots.forEach((dot, index) => {
                    if (index === step) {
                        dot.style.background = '#FF69B4'; 
                        dot.style.boxShadow = '0 3px 10px rgba(255,105,180,0.4)';
                        dot.style.transform = 'scale(1.2)';
                    } else {
                        dot.style.background = 'rgba(255,105,180,0.3)'; 
                        dot.style.boxShadow = 'none';
                        dot.style.transform = 'scale(1)';
                    }
                });
            }

            function nextTutorialStep() {
                if (currentTutorialStep < totalTutorialSteps - 1) {
                    goToTutorialStep(currentTutorialStep + 1);
                }
            }

            function prevTutorialStep() {
                if (currentTutorialStep > 0) {
                    goToTutorialStep(currentTutorialStep - 1);
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                goToSlide(1);

                if (window.elementSdk) {
                    window.elementSdk.init({
                        defaultConfig,
                        render,
                        mapToCapabilities,
                        mapToEditPanelValues
                    });
                }
            });

            document.addEventListener('keydown', function(e) {
                const isQuestionModalOpen = document.getElementById('questionModal').style.display === 'flex';

                if (isQuestionModalOpen) {
                    if (e.key === 'Enter') {
                        if (currentQuestion && currentQuestion.type === 'challenge') {
                            closeQuestionAsCorrect(); 
                        } else {
                            checkAnswer(); 
                        }
                    } else if (e.key === 'Escape') {
                        closeQuestion(); 
                    }
                    return;
                }

                if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'PageDown') {
                    nextSlide();
                } else if (e.key === 'ArrowLeft' || e.key === 'PageUp') {
                    prevSlide();
                } else if (e.key === 'F5' || e.key === 'Home') {
                    e.preventDefault();
                    resetGame();
                    goToSlide(1); 
                } else if (e.key === 'End') {
                    goToSlide(totalSlides);
                }

                if (currentSlide === 3) {
                    const candies = Array.from(document.querySelectorAll('.candy:not(.opened)'));
                    const focusedCandy = document.activeElement;
                    let index = candies.indexOf(focusedCandy);

                    if (e.key === 'ArrowUp' && index >= 4) {
                        e.preventDefault();
                        candies[index - 4].focus();
                    } else if (e.key === 'ArrowDown' && index < candies.length - 4) {
                        e.preventDefault();
                        candies[index + 4].focus();
                    } else if (e.key === 'ArrowLeft' && index % 4 !== 0) {
                        e.preventDefault();
                        candies[index - 1].focus(); 
                    } else if (e.key === 'ArrowRight' && index % 4 !== 3 && index < candies.length - 1) {
                        e.preventDefault();
                        candies[index + 1].focus(); 
                    }

                    if (/^[1-9]$|^10$/.test(e.key)) {
                        const candyNumber = parseInt(e.key);
                        if (candyNumber >= 1 && candyNumber <= 10 && !openedCandies.has(candyNumber)) {
                            openCandy(candyNumber);
                            document.getElementById(`candy-${candyNumber}`).focus();
                        }
                    }
                }
            });

            let countdownInterval = null;
            let countdownTime = 15;
            let isTimerRunning = false;
            let skipRequested = false;

            function showQuestion(question) {
                document.getElementById('questionText').innerHTML = `
                    <div style="font-size: 1.2rem; color: #FF69B4; margin-bottom: 15px; font-weight: 600;">${currentQuestion.category}</div>
                    <div>${question}</div>
                `;

                const answerSection = document.getElementById('answerSection');
                const answerInput = document.getElementById('answerInput');
                const buttonsContainer = document.getElementById('questionButtons');

                if (currentQuestion.type === 'challenge') {
                    answerInput.style.display = 'none';
                    buttonsContainer.innerHTML = `
                        <button class="btn btn-challenge" onclick="closeQuestionAsCorrect()">Ho√†n th√†nh th·ª≠ th√°ch</button>
                        <button class="btn btn-close" onclick="closeQuestion()">Tho√°t</button>
                    `;
                } else {
                    answerInput.style.display = 'block';
                    buttonsContainer.innerHTML = `
                        <button class="btn btn-correct" onclick="checkAnswer()">Ki·ªÉm tra ƒë√°p √°n</button>
                        <button class="btn btn-close" onclick="closeQuestion()">Tho√°t c√¢u h·ªèi</button>
                    `;
                }

                document.getElementById('questionModal').style.display = 'flex';
                resetToPlayAgain();
            }

            document.getElementById('playButton').onclick = function() {
                if (isTimerRunning) {
                    skipCountdown();
                } else {
                    startCountdown();
                }
            };

            function resetToPlayAgain() {
                stopCountdown();
                skipRequested = false;
                document.getElementById('playButton').textContent = '‚ñ∂Ô∏è';
                document.getElementById('playButton').classList.remove('counting');
                document.getElementById('playButton').style.display = 'block';
                document.getElementById('countdownTimer').style.display = 'none';
                document.getElementById('thinkingMessage').style.display = 'none';
                document.getElementById('answerSection').style.display = 'none';
                document.getElementById('answerInput').value = '';
            }

            function startCountdown() {
                if (isTimerRunning) return;
                isTimerRunning = true;
                skipRequested = false;

                document.getElementById('playButton').textContent = '‚è© B·ªè qua 15s';
                document.getElementById('playButton').classList.add('counting');
                document.getElementById('playButton').style.display = 'block';
                document.getElementById('countdownTimer').style.display = 'flex';
                document.getElementById('thinkingMessage').style.display = 'block';
                document.getElementById('answerSection').style.display = 'none';

                countdownTime = 15;
                document.getElementById('countdownText').textContent = '15';
                document.getElementById('countdownText').classList.remove('countdown-warning');

                const circle = document.getElementById('countdownCircle');
                circle.style.animation = 'none';
                circle.offsetHeight;
                circle.style.animation = 'countdownRotate 15s linear forwards';

                countdownInterval = setInterval(() => {
                    countdownTime--;
                    document.getElementById('countdownText').textContent = countdownTime;

                    if (countdownTime <= 5) {
                        document.getElementById('countdownText').classList.add('countdown-warning');
                    }
                    if (countdownTime <= 0 || skipRequested) {
                        clearInterval(countdownInterval);
                        countdownInterval = null;
                        isTimerRunning = false;
                        skipRequested = false;

                        document.getElementById('countdownTimer').style.display = 'none';
                        document.getElementById('thinkingMessage').style.display = 'none';
                        document.getElementById('answerSection').style.display = 'block';
                        document.getElementById('playButton').style.display = 'none';
                        document.getElementById('answerInput').focus();
                    }
                }, 1000);
            }

            function skipCountdown() {
                if (!isTimerRunning) return;
                skipRequested = true;
            }

            function stopCountdown() {
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                    countdownInterval = null;
                }
                isTimerRunning = false;
                skipRequested = false;
            }

            document.addEventListener('keydown', function(e) {
                if (document.getElementById('questionModal').style.display === 'flex') {
                    if (e.key === 'Enter' && isTimerRunning) {
                        e.preventDefault();
                        skipCountdown();
                    }
                }
            });
        </script>

        <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9908191bc44d8514',t:'MTc2MDc5MTE2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
    </body>
</html>
